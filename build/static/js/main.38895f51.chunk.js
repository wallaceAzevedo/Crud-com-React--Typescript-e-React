(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{25:function(e,t,c){},46:function(e,t,c){"use strict";c.r(t);var n,r=c(1),s=c.n(r),a=c(20),i=c.n(a),o=(c(25),c(2)),u=c(0);!function(e){e.Articles="Articles",e.Authors="Authors"}(n||(n={}));var d=Object(r.createContext)({page:n.Articles,setPage:function(e){return console.warn("no page provider")}}),l=function(){return Object(r.useContext)(d)},j=function(e){var t=e.children,c=Object(r.useState)(n.Articles),s=Object(o.a)(c,2),a=s[0],i=s[1];return Object(u.jsx)(d.Provider,{value:{page:a,setPage:i},children:t})},b=function(){var e=l(),t=e.page,c=e.setPage,r=function(e){return Object(u.jsx)("button",{className:e===t?"active ":"",onClick:function(){return c(e)},children:e})};return Object(u.jsxs)("header",{children:[Object(u.jsxs)("h1",{children:[Object(u.jsx)("div",{className:"title",children:"TypeScript CRUD"}),Object(u.jsx)("div",{className:"subtitle",children:" With React And TypeORM"})]}),Object(u.jsxs)("div",{className:"navigation",children:[Object(u.jsxs)("div",{className:"internal",children:[r(n.Articles),r(n.Authors)]}),Object(u.jsx)("div",{className:"external",children:Object(u.jsx)("a",{href:"https://github.com/wallaceAzevedo/Crud-com-React--Typescript-e-React",target:"_blank",rel:"noreferrer",className:"button",children:"GitHub"})})]})]})},h=c(4),O=c.n(h),v=c(5),p=c(6),x=c.n(p),m=function(e,t){var c=Object(r.useState)([]),n=Object(o.a)(c,2),s=n[0],a=n[1],i=Object(r.useState)(+new Date),u=Object(o.a)(i,2),d=u[0],l=u[1],j=Object(r.useState)(!1),b=Object(o.a)(j,2),h=b[0],p=b[1],m=Object(r.useState)(),f=Object(o.a)(m,2),g=f[0],F=f[1],N="".concat("https://typescript-crud-api.herokuapp.com","/").concat(e);return Object(r.useEffect)((function(){var e=function(){var e=Object(v.a)(O.a.mark((function e(){var c;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.prev=1,e.next=4,x.a.get(N,{params:t});case 4:c=e.sent,a(c.data),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),F(e.t0);case 11:p(!1);case 12:case"end":return e.stop()}}),e,null,[[1,8]])})));return function(){return e.apply(this,arguments)}}();e()}),[N,t,d]),{records:s,setVersion:l,loading:h,error:g}},f=function(e){var t=e.text;return Object(u.jsx)("div",{className:"status",children:Object(u.jsx)("span",{className:"status-text",children:t})})},g=function(e){var t,c,n,r,s=e.error,a=null===s||void 0===s||null===(t=s.response)||void 0===t||null===(c=t.data)||void 0===c?void 0:c.validation;return Object(u.jsxs)("div",{className:"error",children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Message:"}),s.message]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"URL:"}),s.config.url]}),(null===(n=s.response)||void 0===n?void 0:n.data.message)&&Object(u.jsxs)("div",{children:[Object(u.jsx)("b",{children:"Details"}),null===(r=s.response)||void 0===r?void 0:r.data.message]}),a&&a.map((function(e,t){return Object(u.jsx)("ul",{children:e.constraints&&Object.values(e.constraints).map((function(e,t){return Object(u.jsx)("li",{children:e},t)}))},t)}))]})},F=function(e){var t=e.ListItem,c=e.records,n=e.emptyRecord,r=e.activeRecord,s=e.setActiveRecord,a=e.loading,i=e.error,o=l().page;return Object(u.jsxs)("div",{className:"list",children:[i&&Object(u.jsx)(g,{error:i}),Object(u.jsxs)("div",{children:[Object(u.jsx)("h2",{children:o}),Object(u.jsx)("button",{className:"bt-new",onClick:function(){return s(n)},children:"New"}),Object(u.jsx)("ul",{children:c.map((function(e){return Object(u.jsx)("li",{className:e.id===(null===r||void 0===r?void 0:r.id)?"active":"",onClick:function(){return s(e)},children:Object(u.jsx)(t,{record:e})},e.id)}))})]}),a&&Object(u.jsx)(f,{text:"Loading..."})]})},N=c(9),R=c(11),S=function(e){var t=e.FormFields,c=e.activeRecord,n=e.submitAction,s=e.success,a=function(e,t){var c=Object(r.useState)(e),n=Object(o.a)(c,2),s=n[0],a=n[1];return{formState:s,setFormState:a,handleChange:function(e){var t=e.target,c=t.tagName,n=t.name,r=t.value,i="SELECT"===c&&""===r?null:r;a(Object(R.a)(Object(R.a)({},s),{},Object(N.a)({},n,i)))},handleSubmit:function(e){e.preventDefault(),t(s)}}}(c,n),i=a.formState,d=a.setFormState,l=a.handleChange,j=a.handleSubmit;return Object(r.useEffect)((function(){(c.id||s)&&d(c)}),[d,c,s]),Object(u.jsx)("div",{children:Object(u.jsxs)("form",{onSubmit:j,children:[Object(u.jsx)(t,{formState:i,handleChange:l}),Object(u.jsx)("input",{type:"submit"})]})})},y=function(e){var t=e.FormFields,c=e.activeRecord,n=e.create,r=e.success;return Object(u.jsxs)("div",{className:"new",children:[Object(u.jsx)("h2",{children:"New"}),Object(u.jsx)(S,{FormFields:t,activeRecord:c,submitAction:n,success:r})]})},w=function(e){var t=e.FormFields,c=e.activeRecord,n=e.update,r=e.remove,s=e.success;return Object(u.jsxs)("div",{className:"edit",children:[Object(u.jsx)("button",{className:"bt-remove",onClick:function(){return r(c)},children:"Remove"}),Object(u.jsx)("h2",{children:"Edit"}),Object(u.jsx)(S,{FormFields:t,activeRecord:c,submitAction:n,success:s})]})},C=function(e){var t=e.FormFields,c=e.activeRecord,n=function(e,t){var c=Object(r.useState)(!1),n=Object(o.a)(c,2),s=n[0],a=n[1],i=Object(r.useState)(),u=Object(o.a)(i,2),d=u[0],l=u[1],j=Object(r.useState)(),b=Object(o.a)(j,2),h=b[0],p=b[1],m="".concat("https://typescript-crud-api.herokuapp.com","/").concat(e),f=function(e){return function(){var c=Object(v.a)(O.a.mark((function c(n){return O.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:a(!0),l(void 0),p(void 0),e(n).then((function(){l(!0),t&&t()})).catch((function(e){l(!1),p(e)})).finally((function(){a(!1)}));case 4:case"end":return c.stop()}}),c)})));return function(e){return c.apply(this,arguments)}}()},g=f(function(){var e=Object(v.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post(m,t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),F=f(function(){var e=Object(v.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.post("".concat(m,"/").concat(t.id),t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),N=f(function(){var e=Object(v.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,x.a.delete("".concat(m,"/").concat(t.id));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return{create:g,update:F,remove:N,processing:s,success:d,error:h,setError:p}}(e.apiPath,e.callback),s=n.create,a=n.update,i=n.remove,d=n.processing,l=n.success,j=n.error,b=n.setError;return Object(r.useEffect)((function(){c.id&&b(void 0)}),[c,b]),Object(u.jsxs)("div",{className:"mutations",children:[j&&Object(u.jsx)(g,{error:j}),c.id?Object(u.jsx)(w,{FormFields:t,activeRecord:c,update:a,remove:i,success:l}):Object(u.jsx)(y,{FormFields:t,activeRecord:c,create:s,success:l}),d&&Object(u.jsx)(f,{text:"processing..."})]})},A=function(e){var t=e.ListItem,c=e.apiPath,n=e.apiOptions,s=e.FormFields,a=e.emptyRecord,i=Object(r.useState)(a),d=Object(o.a)(i,2),l=d[0],j=d[1],b=m(c,n),h=b.records,O=b.setVersion,v=b.loading,p=b.error;return Object(u.jsx)("div",{className:"page",children:Object(u.jsxs)("div",{className:"content",children:[Object(u.jsx)(F,{ListItem:t,records:h,emptyRecord:a,activeRecord:l,setActiveRecord:j,loading:v,error:p}),Object(u.jsx)(C,{FormFields:s,activeRecord:l,apiPath:c,callback:function(){O(+new Date),j(a)}})]})})},k=function(e){var t,c=e.record;return Object(u.jsxs)("div",{children:[Object(u.jsx)("div",{className:"title",children:c.title}),Object(u.jsxs)("div",{className:"author",children:["By ",(null===(t=c.author)||void 0===t?void 0:t.name)||"Desconhecido"]})]})},P=function(e){var t=e.formState,c=e.handleChange,n=m("authors");return Object(u.jsxs)("div",{children:[Object(u.jsxs)("div",{children:[Object(u.jsx)("label",{children:"Title"}),Object(u.jsx)("input",{type:"text",name:"title",value:t.title,onChange:c})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("label",{children:"Text"}),Object(u.jsx)("textarea",{name:"text",value:t.text,onChange:c,rows:5})]}),Object(u.jsxs)("div",{children:[Object(u.jsx)("label",{children:"Author"}),Object(u.jsxs)("select",{name:"author",value:t.author?t.author.id:"",onChange:c,children:[Object(u.jsx)("option",{value:"",children:"Select"}),n.records.map((function(e){return Object(u.jsx)("option",{value:e.id,children:e.name},e.id)}))]})]})]})},L=function(){return Object(u.jsx)(A,{ListItem:k,apiPath:"articles",apiOptions:{relations:["author"]},FormFields:P,emptyRecord:{title:"",text:""}})},E=function(e){var t=e.record;return Object(u.jsx)("div",{className:"title",children:t.name})},T=function(e){var t=e.formState,c=e.handleChange;return Object(u.jsx)("div",{children:Object(u.jsxs)("div",{children:[Object(u.jsx)("label",{children:"Name"}),Object(u.jsx)("input",{type:"text",name:"name",value:t.name,onChange:c})]})})},D=function(){return Object(u.jsx)(A,{ListItem:E,apiPath:"authors",apiOptions:{},FormFields:T,emptyRecord:{name:""}})},I=function(){var e=l().page;return Object(u.jsxs)("div",{className:"App",children:[Object(u.jsx)(b,{}),function(){switch(e){case n.Articles:return Object(u.jsx)(L,{});case n.Authors:return Object(u.jsx)(D,{});default:return""}}()]})},B=function(e){e&&e instanceof Function&&c.e(3).then(c.bind(null,47)).then((function(t){var c=t.getCLS,n=t.getFID,r=t.getFCP,s=t.getLCP,a=t.getTTFB;c(e),n(e),r(e),s(e),a(e)}))};i.a.render(Object(u.jsx)(s.a.StrictMode,{children:Object(u.jsx)(j,{children:Object(u.jsx)(I,{})})}),document.getElementById("root")),B()}},[[46,1,2]]]);
//# sourceMappingURL=main.38895f51.chunk.js.map