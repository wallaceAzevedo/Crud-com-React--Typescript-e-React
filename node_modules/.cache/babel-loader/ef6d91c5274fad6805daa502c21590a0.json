{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/User/Desktop/Crud-com-React--Typescript-e-React/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/User/Desktop/Crud-com-React--Typescript-e-React/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/User/Desktop/Crud-com-React--Typescript-e-React/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState}from'react';import axios from'axios';export var useMutation=function useMutation(path,callback){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),processing=_useState2[0],setProcessing=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),success=_useState4[0],setSuccess=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),error=_useState6[0],setError=_useState6[1];var url=\"\".concat(process.env.REACT_APP_API,\"/\").concat(path);var wrap=function wrap(fn){return/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(record){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:setProcessing(true);setSuccess(undefined);setError(undefined);fn(record).then(function(){setSuccess(true);if(callback){callback();}}).catch(function(error){setSuccess(false);setError(error);}).finally(function(){setProcessing(false);});case 4:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref.apply(this,arguments);};}();};var create=wrap(/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(record){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.post(url,record);case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref2.apply(this,arguments);};}());var update=wrap(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(record){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return axios.post(\"\".concat(url,\"/\").concat(record.id),record);case 2:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref3.apply(this,arguments);};}());var remove=wrap(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(record){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return axios.delete(\"\".concat(url,\"/\").concat(record.id));case 2:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x4){return _ref4.apply(this,arguments);};}());return{create:create,update:update,remove:remove,processing:processing,success:success,error:error,setError:setError};};","map":{"version":3,"sources":["C:/Users/User/Desktop/Crud-com-React--Typescript-e-React/src/hooks/useMutation.ts"],"names":["useState","axios","useMutation","path","callback","processing","setProcessing","success","setSuccess","error","setError","url","process","env","REACT_APP_API","wrap","fn","record","undefined","then","catch","finally","create","post","update","id","remove","delete"],"mappings":"0gBAAA,OAASA,QAAT,KAAyB,OAAzB,CACA,MAAOC,CAAAA,KAAP,KAAgC,OAAhC,CAKA,MAAO,IAAMC,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CACvBC,IADuB,CAEvBC,QAFuB,CAGnB,CAEJ,cAAqCJ,QAAQ,CAAU,KAAV,CAA7C,wCAAQK,UAAR,eAAoBC,aAApB,eACA,eAA+BN,QAAQ,EAAvC,yCAAQO,OAAR,eAAiBC,UAAjB,eACA,eAA2BR,QAAQ,EAAnC,yCAAQS,KAAR,eAAeC,QAAf,eAEA,GAAMC,CAAAA,GAAG,WAAMC,OAAO,CAACC,GAAR,CAAYC,aAAlB,aAAmCX,IAAnC,CAAT,CAEA,GAAMY,CAAAA,IAAI,CAAG,QAAPA,CAAAA,IAAO,CAACC,EAAD,CAAmB,CAC5B,+FAAO,iBAAOC,MAAP,kHACHX,aAAa,CAAC,IAAD,CAAb,CACAE,UAAU,CAACU,SAAD,CAAV,CACAR,QAAQ,CAACQ,SAAD,CAAR,CACAF,EAAE,CAACC,MAAD,CAAF,CACKE,IADL,CACU,UAAM,CACRX,UAAU,CAAC,IAAD,CAAV,CACA,GAAIJ,QAAJ,CAAc,CACVA,QAAQ,GACX,CACJ,CANL,EAOKgB,KAPL,CAOW,SAACX,KAAD,CAAgB,CACnBD,UAAU,CAAC,KAAD,CAAV,CACAE,QAAQ,CAACD,KAAD,CAAR,CACH,CAVL,EAWKY,OAXL,CAWa,UAAM,CACXf,aAAa,CAAC,KAAD,CAAb,CACH,CAbL,EAJG,sDAAP,+DAmBH,CApBD,CAsBA,GAAMgB,CAAAA,MAAiB,CAAGP,IAAI,2FAAC,kBAAOE,MAAP,6IACrBhB,CAAAA,KAAK,CAACsB,IAAN,CAAWZ,GAAX,CAAeM,MAAf,CADqB,yDAAD,iEAA9B,CAIA,GAAMO,CAAAA,MAAiB,CAAGT,IAAI,2FAAC,kBAAOE,MAAP,6IACrBhB,CAAAA,KAAK,CAACsB,IAAN,WAAcZ,GAAd,aAAqBM,MAAM,CAACQ,EAA5B,EAAkCR,MAAlC,CADqB,yDAAD,iEAA9B,CAIA,GAAMS,CAAAA,MAAiB,CAAGX,IAAI,2FAAC,kBAAOE,MAAP,6IACrBhB,CAAAA,KAAK,CAAC0B,MAAN,WAAgBhB,GAAhB,aAAuBM,MAAM,CAACQ,EAA9B,EADqB,yDAAD,iEAA9B,CAIA,MAAO,CACHH,MAAM,CAANA,MADG,CAEHE,MAAM,CAANA,MAFG,CAGHE,MAAM,CAANA,MAHG,CAIHrB,UAAU,CAAVA,UAJG,CAKHE,OAAO,CAAPA,OALG,CAMHE,KAAK,CAALA,KANG,CAOHC,QAAQ,CAARA,QAPG,CAAP,CAUH,CAvDM","sourcesContent":["import { useState } from 'react';\r\nimport axios, {AxiosError} from 'axios';\r\nimport { Record } from '../interfaces/RecordEntities';\r\n\r\nexport type Action<T> = (record:T)=> Promise<void>;\r\n\r\nexport const useMutation = <T extends Record>(\r\n    path: string,\r\n    callback?: Function\r\n    )=> {\r\n\r\n    const [ processing, setProcessing] = useState<boolean>(false);\r\n    const [ success, setSuccess] = useState<boolean>();\r\n    const [ error, setError] = useState<AxiosError>();\r\n\r\n    const url = `${process.env.REACT_APP_API}/${path}`;\r\n\r\n    const wrap = (fn: Action<T>) => {\r\n        return async (record:T) => {\r\n            setProcessing(true)\r\n            setSuccess(undefined)\r\n            setError(undefined)\r\n            fn(record)\r\n                .then(() => {\r\n                    setSuccess(true);\r\n                    if (callback) {\r\n                        callback();\r\n                    }\r\n                })\r\n                .catch((error:Error)=> {\r\n                    setSuccess(false);\r\n                    setError(error as AxiosError);\r\n                })\r\n                .finally(() => {\r\n                    setProcessing(false)\r\n                });\r\n        };\r\n    };\r\n\r\n    const create: Action<T> = wrap(async (record:T) => {\r\n        await axios.post(url,record);\r\n    });\r\n\r\n    const update: Action<T> = wrap(async (record:T) => {\r\n        await axios.post(`${url}/${record.id}`, record);\r\n    })\r\n\r\n    const remove: Action<T> = wrap(async (record:T) => {\r\n        await axios.delete(`${url}/${record.id}`);\r\n    })\r\n\r\n    return {\r\n        create,\r\n        update,\r\n        remove,\r\n        processing,\r\n        success,\r\n        error,\r\n        setError,\r\n    };\r\n\r\n}"]},"metadata":{},"sourceType":"module"}